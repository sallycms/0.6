(function(a){a.fn.datetime=function(b){var c=b.userLang||"en",d=!b.americanMode&&!0,e="hasDateTime",f=b.dateFormat;return this.each(function(){function b(b,c){var d=a("#pickerplug");c=="time"?d.data("lasttime",b+":00"):d.data("lastdate",b),a(d.data("inputfield")).val(d.data("lastdate")+" "+d.data("lasttime"))}function i(b,c){var d="";switch(c){case"hour":var e=parseInt(b,10);!a("#pickerplug").data("b24Hour")&&e>11?(e-=12,a(".dayPeriod").text("pm")):a("#pickerplug").data("b24Hour")||a(".dayPeriod").text("am"),e<10&&(e="0".concat(e)),b<10&&(b="0".concat(parseInt(b,10))),a("#tpSelectedTime .selHrs").text(e),d=b+":"+a("#tpSelectedTime .selMins").text();break;case"minute":var f=(b<10?"0":"")+parseInt(b,10);a("#tpSelectedTime .selMins").text(f),d=a("#hourSlider").slider("option","value")+":"+f}return d}function j(b){var c=a(b||this).val().split(" "),d=null;c.length>=2?(d=c.slice(0,-1).join(" "),c=c.pop()):(d=c[0],c="00:00:00"),a("#pickerplug").data("lastdate",d).data("lasttime",c),c=c.split(":"),c.length<2&&c.push("00");var e=c[0]||"00",f=c[1]||"00";i(e,"hour"),i(f,"minute"),a("#hourSlider").slider("option","value",e),a("#minuteSlider").slider("option","value",f),a("#datepicker").datepicker("setDate",a.datepicker.parseDate(g.dateFormat,a("#pickerplug").data("lastdate")))}function k(b){var c=a(b.target);if((c.parents("#pickerplug").length||c.hasClass(e))&&!c.hasClass("ui-datepicker-close"))return;a("#pickerplug").hide("slow"),a(this).unbind("click",k).unbind("keyup",j).removeClass(e)}function l(c,e){var f=h[e]||h.en;if(!a("#pickerplug").length){var g='<ul id="pickerplug">';g+="<li>",g+='<div id="datepicker"></div>',g+="</li>",g+="<li>",g+='<div id="timepicker" class="ui-corner-all ui-widget-content">',g+='<h3 id="tpSelectedTime">',g+='\t<span id="text_time"></span>',g+='\t<span class="selHrs" >00</span>',g+='\t<span class="delim" >:</span>',g+='\t<span class="selMins">00</span>',g+='\t<span class="dayPeriod">am</span>',g+="</h3>",g+='<ul id="sliderContainer">',g+="\t<li>",g+='        <h4 id="text_hour"></h4>',g+='        <div id="hourSlider" class="slider"></div>',g+="\t</li>",g+="\t<li>",g+='        <h4 id="text_minute"></h4>',g+='        <div id="minuteSlider" class="slider"></div>',g+="\t</li>",g+="</ul>",g+="</div>",g+='<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" id="text_close"></button>',g+="</li>",g+="</ul>",a("body").append(g),a("#datepicker").datepicker(),a(document).mousedown(k),a("#pickerplug .ui-datepicker-close").click(k),a("#hourSlider").slider({orientation:"vertical",range:"min",min:0,max:23,step:1,slide:function(a,c){b(i(c.value,"hour"),"time")},change:function(b,c){a("#tpSelectedTime .selHrs").effect("highlight",1e3)}}),a("#minuteSlider").slider({orientation:"vertical",range:"min",min:0,max:55,step:5,slide:function(a,c){b(i(c.value,"minute"),"time")},change:function(b,c){a("#tpSelectedTime .selMins").effect("highlight",1e3)}}),a("#tpSelectedTime .selHrs").keyup(function(b){var c=a(this);b.which<=57&&b.which>=48&&c.text()>=1&&c.text()<=12?a("#hourSlider").slider("value",parseInt(c.text(),10)):c.val(c.text().slice(0,-1))}),a("#tpSelectedTime .selMins").keyup(function(b){var c=a(this);b.which<=57&&b.which>=48&&c.text()>=0&&c.text()<=59?a("#minuteSlider").slider("value",parseInt(c.text(),10)):c.val(c.text().slice(0,-1))})}a(".dayPeriod").toggle(!d),a("#text_time").text(f.time),a("#text_hour").text(f.hour),a("#text_minute").text(f.minute),a("#text_close").text(f.close),a("#pickerplug").data("userLang",e),a("#pickerplug").data("b24Hour",c)}var g={changeMonth:!0,changeYear:!0,dateFormat:f,showButtonPanel:!0,onSelect:b},h={};h.en={time:"Time",hour:"Hour",minute:"Minute",close:"Close"},h.de={time:"Zeit",hour:"Stunde",minute:"Minute",close:"SchlieÃŸen"},a(this).data("sets",g).data("userLang",c).data("b24Hour",d),a(this).bind("focus",function(){var b=a(this),c=b.offset().top+b.outerHeight(),d=b.offset().left,f=a("#pickerplug"),g=a("#datepicker");(b.data("userLang")!=f.data("userLang")||b.data("b24Hour")!=f.data("userLang"))&&l(b.data("b24Hour"),b.data("userLang")),f=a("#pickerplug"),g=a("#datepicker"),f.css({left:d+"px",top:c+"px"}).show("slow"),b.data("userLang")!="en"&&h[b.data("userLang")]?(g.datepicker("option",a.extend({},a.datepicker.regional[b.data("userLang")])),g.datepicker("option",a.extend(b.data("sets")))):(g.datepicker("option",a.extend({},a.datepicker.regional[""])),g.datepicker("option",a.extend(b.data("sets")))),j(this),f=a("#pickerplug"),g=a("#datepicker"),f.css("display")=="none"&&f.show("slow"),b.bind("keyup",j).addClass(e),f.data("inputfield",this)})})}})(jQuery);